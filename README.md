# Лабораторна робота №7. Дослідження фільтра Калмана</h1>

## Ознайомитись з кодом програми можливо у файлі "app.py"

### Мета роботи:
<ol>
    <li>Ознайомитися з роботою фільтра Калмана та принципами його застосування.</li>
    <li>Вивчити вплив різних параметрів фільтра на результати згладжування сигналу.</li>
    <li>Навчитися аналізувати результати фільтрації, враховуючи значення дисперсії шуму до та після фільтрації.</li>
</ol>

<p>
    <b>Основне завдання:</b>
</p>
<ol>
    <li>
        <b>Ініціалізація коду:</b>
        <ul>
            <li>Використайте код, що наданий у розділі "Теоретичні відомості", як базовий шаблон.</li>
            <li>Переконайтеся, що всі параметри фільтра Калмана (F, H, Q, R, P, x) задані правильно та відповідають початковому варіанту.</li>
        </ul>
    </li>
    <li>
        <b>Дослідження впливу параметрів:</b>
        Послідовно змінюйте значення кожного з наступних параметрів фільтра Калмана:
        <ul>
            <li>Матриця коваріації шуму процесу (Q): збільшуйте та зменшуйте значення, аналізуйте, як це впливає на передбачення.</li>
            <li>Матриця коваріації шуму вимірювання (R): змініть цей параметр, щоб побачити, як фільтр реагує на зміну довіри до вимірювань.</li>
            <li>Початкова матриця коваріації (P): експериментуйте з різними початковими невпевненостями щодо стану.</li>
            <li>Початкова оцінка стану (Initial state estimate): спробуйте різні початкові значення та простежте, як це впливає на збіжність фільтра.</li>
            <li>Постійна складова сигналу (offset): змініть зсув сигналу, щоб оцінити, наскільки фільтр адаптується до зміщеного сигналу.</li>
            <li>Загальний час моделювання (total_time): для фільтрацій із дуже інерційними параметрами, змініть загальний час симуляції, щоб переконатися, що фільтр встигає "налаштуватися" та стабілізувати свої результати.</li>
        </ul>
    </li>
    <li>
        <b>Порівняння результатів:</b>
        Для кожної комбінації параметрів:
        <ul>
            <li>Розрахуйте дисперсію шуму до фільтрації та після фільтрації.</li>
            <li>Створіть графік, що показує результати фільтрації у порівнянні з реальним сигналом та шумним сигналом.</li>
            <li>Зробіть скріншоти кожного графіка та додайте їх у звіт.</li>
        </ul>
    </li>
    <li>
        <b>Аналіз та висновки:</b>
        <ul>
            <li>Зафіксуйте значення дисперсії шуму до і після фільтрації.</li>
            <li>Для кожного випадку фільтрації прокоментуйте результати.</li>
            <li>Поясніть, як зміна конкретного параметра вплинула на передбачення, корекцію стану та зміну дисперсії.</li>
            <li>Сформулюйте загальні висновки щодо поведінки фільтра Калмана при різних комбінаціях параметрів.</li>
        </ul>
    </li>
</ol>

### Реалізація фільтру Калмана

<p>Код побудований на Python з використанням бібліотек Flask, NumPy та Matplotlib.</p>

<p>Код складається з кількох основних частин. Інтерфейс користувача забезпечує введення параметрів фільтра через форму, яка інтерактивно оновлюється залежно від даних користувача. Готовий інтерфейс дозволяє швидко змінювати параметри та візуалізувати результати.</p>

<p>Клас <code>KalmanFilter</code> реалізує основну логіку роботи фільтра. Метод <code>predict()</code> передбачає наступний стан системи, враховуючи попередній стан і матрицю переходу, а <code>update(z)</code> оновлює стан на основі нового вимірювання та обчислює коефіцієнт Калмана для зменшення невизначеності.</p>

<p>Симуляція сигналу включає моделювання реального сигналу у вигляді синусоїди із заданими параметрами (частота, амплітуда, зсув), до якого додається шум для перевірки ефективності фільтрації в умовах завад. Візуалізація реалізується через графіки, які показують шумний сигнал, реальний сигнал та оцінки фільтра. Ці графіки зберігаються у вигляді зображень і передаються у веб-інтерфейс.</p>

<p align="center"> <img src="Screenshots/1.png" alt="Реалізація фільтру Калмана"/> </p>

<h2>Дослідження впливу параметрів</h2>

<ol>
    <li>
        <h3>Матриця коваріації шуму процесу (Process Noise Covariance (Q)):</h3>
        <p>Цей параметр визначає рівень довіри до моделі процесу. Збільшення Q робить фільтр більш гнучким, дозволяючи швидше реагувати на зміни в системі. (Q = 100,0)</p>
        <p align="center"> <img src="Screenshots/2.png" alt="Збільшення Q"/> </p>
        <p>У разі надто великого Q фільтр може перестати ефективно згладжувати шум, а при малих значеннях Q знижується чутливість до змін сигналу. (Q = 0,1)</p>
        <p align="center"> <img src="Screenshots/3.png" alt="Зменшення Q"/> </p>
    </li>
    <li>
        <h3>Матриця коваріації шуму вимірювання (Measurement Noise Covariance (R)):</h3>
        <p>Відповідає за довіру до вимірювань. Високі значення R означають, що фільтр більше покладається на передбачення, ніж на вимірювання. (R = 100,0)</p>
        <p align="center"> <img src="Screenshots/4.png" alt="Збільшення R"/> </p>
        <p>За низького R фільтр надає перевагу вимірюванням, що може призводити до чутливості до шумів у даних. (R = 1,0)</p>
        <p align="center"> <img src="Screenshots/5.png" alt="Зменшення R"/> </p>
    </li>
    <li>
        <h3>Початкова матриця коваріації (Initial Estimate Error Covariance (P)):</h3>
        <p>Визначає початкову невпевненість у стані системи. Високе значення P може призвести до тривалого процесу збіжності. (P = 100,0)</p>
        <p align="center"> <img src="Screenshots/6.png" alt="Збільшення P"/> </p>
        <p>Низькі значення P прискорюють збіжність, але можуть бути недостатньо точними на початкових етапах. (P = 0,1)</p>
        <p align="center"> <img src="Screenshots/7.png" alt="Зменшення P"/> </p>
    </li>
    <li>
        <h3>Початкова оцінка стану (Initial State (x)):</h3>
        <p>Впливає на перші ітерації роботи фільтра. Якщо початкове значення значно перевищує реальний стан, це може спричинити уповільнення збіжності та збільшення початкової похибки. (x = 50,0)</p>
        <p align="center"> <img src="Screenshots/8.png" alt="Збільшення x"/> </p>
        <p>Зменшення початкового значення x, якщо воно ближче до реального стану, дозволяє швидше стабілізуватися результатам. (x = 1,0)</p>
        <p align="center"> <img src="Screenshots/9.png" alt="Зменшення x"/> </p>
    </li>
    <li>
        <h3>Постійна складова сигналу (Offset):</h3>
        <p>Визначає базовий рівень сигналу. Збільшення постійної складової сигналу призводить до зміщення середнього рівня сигналу вгору, і фільтр демонструє здатність адаптуватися до нового середовища. (Offset = 100,0)</p>
        <p align="center"> <img src="Screenshots/10.png" alt="Збільшення Offset"/> </p>
        <p>Зменшення викликає зсув середнього рівня сигналу вниз. Фільтр також може адаптуватися до цих змін, але при значних зменшеннях параметрів можуть виникати помітні затримки в стабілізації результатів. (Offset = 1,0)</p>
        <p align="center"> <img src="Screenshots/11.png" alt="Зменшення Offset"/> </p>
    </li>
    <li>
        <h3>Загальний час моделювання (Total Time):</h3>
        <p>Визначає тривалість симуляції сигналу. Збільшення часу моделювання дозволяє спостерігати довготривалу стабільність фільтра та його поведінку при різних змінах сигналу. (Total Time = 10,0)</p>
        <p align="center"> <img src="Screenshots/12.png" alt="Збільшення Total Time"/> </p>
        <p>Скорочення часу моделювання може призвести до недостатнього періоду для адаптації фільтра, що ускладнює аналіз короткотермінових змін. (Total Time = 0,1)</p>
        <p align="center"> <img src="Screenshots/13.png" alt="Зменшення Total Time"/> </p>
    </li>
</ol>

<p><h3>Висновок:</h3> Фільтр Калмана ефективно згладжує шумний сигнал, забезпечуючи високу точність при правильному налаштуванні параметрів. Вибір матриць Q та R є ключовим для досягнення балансу між адаптивністю та стабільністю фільтра. Початкові значення P та x значно впливають на швидкість збіжності, хоча їх вплив зменшується після декількох ітерацій. Результати показують, що фільтр може адаптуватися до зміщеного сигналу та стабілізувати оцінки навіть у складних умовах з високим рівнем шуму.</p>

